# Express

## 一、安装

 方式一：安装express-generator

```js
  安装脚手架
  npm install -g express-generator
  创建项目
  express express-demo
  安装依赖
  npm install
  启动项目
  node bin/www
```

访问`localhost:3000`出现hello Express说明启动成功
![express](https://cdn.jsdelivr.net/gh/ailing666/images@master/2021/16377409450341637740945022.png)
方式二：从零搭建自己的express应用结构

```js
  npm init -y
  npm i express
```

## 二、中间件

**中间件必须调用`next()`才会匹配下一个中间件，最后一个中间件用`res.end()`结束**
  
![中间件](https://cdn.jsdelivr.net/gh/ailing666/images@master/2021/16378104654941637810465475.png)

### 1.普通中间件

可以匹配任何请求，任何路径

```js
app.use((req, res, next) => {
  res.end('结束')
})

app.use('/home', (req, res, next) => {
  next()
})
```

### 2.get/post中间件

```js
// get监听默认路径
app.get('/', (req, res, next) => {
  res.end('get请求')
})

// post监听默认路径
app.post('/', (req, res, next) => {
  res.end('post请求')
})

app.post('/login', (req, res, next) => {
  res.end('post请求login')
})
```

### 3.连续调用中间件

```js
app.get("/home", (req, res, next) => {
  console.log("home path and method middleware 02");
  next();
}, (req, res, next) => {
  console.log("home path and method middleware 03");
  next();
}, (req, res, next) => {
  console.log("home path and method middleware 04");
  res.end("home page");
});

```

### 4.express解析json数据

```js
const express = require('express');

const app = express();

// 使用express提供的body解析
app.use(express.json());
// extended
// true: 使用qs解析urlencoded
// false: 使用querystring解析urlencoded
app.use(express.urlencoded({ extended: true }));

app.post('/login', (req, res, next) => {
  console.log(req.body);
  res.end("请求成功");
});

app.listen(8000, () => {
  console.log("express初体验服务器启动成功~");
});

```
