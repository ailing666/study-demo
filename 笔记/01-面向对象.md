# 一.面向对象

## 1. 什么是面向对象

- 把客观对象抽象成属性数据和对数据的相关操作，把内部细节和不相关的信思隐藏起来

- 把同一个类型的客观对象的属性数据和操作定在一起，封装成类

- 以类和对象作为组织代码的基本单位，并实现封装、抽象、继承、多态四个特性

- 允许分成不同层次进行抽象，通过继承实现属性和操作的共享

- 面向对象分析（OOA) Object Oriented Analysis

- 面向对象设计 OOD) Object Oriented Design

- 面向对象编程（ DOP)Object Oriented Programming

### 1.1 抽象（ Abstraction)

- 抽象主要是隐藏方法的实现，让调用者只关心有哪些功能而不是关心功能的实现

- 抽象可以提高代码的可扩展性和维护性，修改实现不需要改变定义，可以减少代码的改动范围

```ts
interface IStorage {
  save(key: string, value: any): void
  read(key: string): any
}
class UserInfo {
  public name: string
  constructor (name: string, public storage: IStorage) {
    this.name = name
  }
  save () {
    this.storage.save('userInfo', JSON.stringify(this))
  }
  read () {
    return this.storage.read('userInfo')
  }
}

// 当想把信息存到localStorage时
class LocalStorage implements IStorage {
  save (key: string, value: any): void {
    localStorage.setItem(key, value)
  }
  read (key: string) {
    return localStorage.getItem(key)
  }
}
let local = new LocalStorage()
let userInfo = new UserInfo('loveZero', local)
console.log(userInfo.name)

// 当想把信息存到mysql时，只需要
class MysqlStorage implements IStorage {
  save (key: string, value: any): void {
    //mysql.setItem(key, value);
  }
  read (key: string) {
    //return mysql.getItem(key);
  }
}
let mysqlStorage = new MysqlStorage()
let userInfo2 = new UserInfo('loveZero', mysqlStorage)
console.log(userInfo2.name)
```

### 1.2 继承

- 类、对象(实例)

- 父类是公共的

- 子类继承父类

- 继承可以把公共方法抽离出来，提高复用，减少冗余

```js
class Animal {
  constructor (name) {
    this.name = name
  }
  eat (food) {
    console.log(`${this.name} eat ${food}`)
  }
}

class Dog extends Animal {
  constructor () {
    super('狗')
  }
  speak () {
    console.log('汪汪汪')
  }
}
let animal = new Animal('小猪')
let dog = new Dog()
animal.eat('食物')
dog.eat('骨头')
dog.speak()
```

### 1.3 封装

- 把数据封装起来

- 减少耦合，不该外部访问的不要让外部访

- 利于数据的接口权限管理

- 实现

  - `public`: 公有修饰符，可以在类内或者类外使用，默认修饰符

  - `protected`: 受保护的修饰符，可以类内和子类中使用

  - `private`:私有修饰符，只可以在类内

```ts
class Person {
  public name: string // 公有属性，自己，自己的子类和其它类都可以访问
  protected age: number // 受保护的属性自己自己的子类能访间，其它类不能访问
  private money: number // 私有的，自己能访间，自己的子类和其它类都不能访问
  constructor (name, age, money) {
    this.name = name
    this.age = age
    this.money = money
  }
}

class Student extends Person {
  public num: number
  constructor (name, age, money, num) {
    super(name, age, money)
    this.num = num
  }
  getName () {
    console.log('name', this.name)
  }
  getAge () {
    console.log('age', this.age)
  }
  getMoney () {
    // console.log('money', this.money); 私有属性无法访问
  }
}

let s1 = new Student('loveZero', 10, 100, 1)
console.log('name: ', s1.name)
s1.getName()
s1.getAge()
// console.log('age: ', s1.age); 值允许在内类和子类中访问
// console.log('age: ', s1.age);
```

### 1.4 多态

多态是一个功能，他的实现主要是拷继承，没继承就没有多态

- 多态是指，子类可以替换父类

- 保持子类的开放性和灵活性，可以重写父类中的方法

- 现面向接口编程

```js
export { }
abstract class Animal {
  abstract speak(): void
}

class Dog extends Animal {
  speak() {
    console.log('汪汪汪');
  }
}

class Cat extends Animal {
  speak() {
    console.log('喵喵喵');
  }
}

function talk(animal: Animal) {
  animal.speak()
}

talk(new Dog())
talk(new Cat())
```
